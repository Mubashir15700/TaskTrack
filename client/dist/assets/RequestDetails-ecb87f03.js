import{r as n,a as N,_ as v,j as e,A as g,S as y,s as w}from"./index-9d72eabb.js";import{a as f,r as A}from"./request-4bc41fef.js";const D=()=>{var u,p,x,j;const[s,d]=n.useState(),[o,t]=n.useState(),{id:l}=N();n.useEffect(()=>{(async()=>{try{const r=await f(l);r&&r.status===200&&r.request?d(r.request):t("Failed to fetch request details.")}catch(r){t("An error occurred while fetching request details."),console.error("Error fetching request details:",r)}})()},[l]);const m=async a=>{const r=await y.confirmAction(`${a==="approve"?"Approve":"Reject"}`,`Are you sure you want to ${a} this request?`,`${a==="approve"?"Approve":"Reject"}`,"#d9534f",`${a==="reject"?"text":""}`);r.isConfirmed&&b(a,r.value)},b=async(a,r)=>{var h;try{const c=await A({requestId:l,userId:(h=s.user)==null?void 0:h._id,type:a,reason:r});if(c)if(c.status===200){const i=await f(l);i&&i.status===200?(v.success("Request successfully updated"),d(i.request),w.emit("request_action",{userId:s.user._id,message:`Your request has been ${a.action==="approve"?"approved":"rejected"}`})):t("Failed to fetch updated request data.")}else t("Something went wrong")}catch(c){t("Failed to update request"),console.error("request action error: ",c)}};return n.useEffect(()=>{o&&v.error(o)},[o]),e.jsx("div",{className:"col-10 my-3 mx-auto",children:s?e.jsx("div",{className:"p-3 p-lg-5 border",children:e.jsxs("div",{children:[e.jsxs("div",{className:"form-group row",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{children:"Username"}),e.jsx("input",{type:"text",className:"form-control",name:"username",value:(u=s==null?void 0:s.user)==null?void 0:u.username,disabled:!0})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{children:"Phone"}),e.jsx("input",{type:"number",className:"form-control",name:"phone",value:(p=s==null?void 0:s.user)==null?void 0:p.phone,disabled:!0})]})]}),e.jsx("div",{className:"form-group row",children:e.jsxs("div",{className:"col-md-12",children:[e.jsx("label",{children:"Email"}),e.jsx("input",{type:"email",className:"form-control",name:"email",value:(x=s==null?void 0:s.user)==null?void 0:x.email,disabled:!0})]})}),e.jsx("div",{className:"col-md-12",children:e.jsx(g,{label:"Lives In",currentAddress:(j=s==null?void 0:s.user)==null?void 0:j.location,usage:"admin"})}),e.jsxs("div",{className:"col-md-12 mt-3",children:[e.jsx("label",{children:"Languages Known"}),e.jsx("input",{type:"text",className:"form-control",name:"languages",value:s==null?void 0:s.languages,disabled:!0})]}),e.jsxs("div",{className:"col-md-12 mt-3",children:[e.jsx("label",{children:"Education"}),e.jsx("input",{type:"text",className:"form-control",name:"education",value:s==null?void 0:s.education,disabled:!0})]}),e.jsxs("div",{className:"form-group row",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{children:"Available Days"}),e.jsx("input",{type:"text",className:"form-control",name:"username",value:s==null?void 0:s.avlDays,disabled:!0})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{children:"Available Times"}),e.jsx("input",{type:"number",className:"form-control",name:"phone",value:s==null?void 0:s.avlTimes,disabled:!0})]})]}),e.jsx("div",{className:"mt-3",children:s.fields&&s.fields.map((a,r)=>e.jsxs("div",{className:"p-3 mb-3",children:[e.jsx("p",{className:"mb-3",children:e.jsxs("strong",{children:["Work Category: ",a.name]})}),e.jsx("div",{className:"row",children:e.jsxs("div",{className:"col-md-6",children:[e.jsxs("p",{className:"mb-1",children:["Works Done: ",a.worksDone]}),e.jsxs("p",{className:"mb-1",children:["Preferred Wage: ",a.wagePerHour]})]})})]},r))}),s.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-warning my-3 me-2",onClick:()=>m("approve"),children:"Approve"}),e.jsx("button",{className:"btn btn-danger my-3",onClick:()=>m("reject"),children:"Reject"})]})]})}):e.jsx("div",{className:"mt-5 mx-auto",children:e.jsx("p",{children:"No data found"})})})};export{D as default};
