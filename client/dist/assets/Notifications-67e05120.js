import{o as v,e as w,q as b,u as y,r as o,j as s,Y as k,V as P,t as S,v as C,w as _,x as E,y as I,_ as A,z as D,B as U}from"./index-e0af1eab.js";import{I as V}from"./index.es-0f4d2f49.js";import{I as L}from"./imageUrls-ebc684b3.js";const M=()=>{const l=v(),x=w(),c=b().state,h=y(e=>{var t;return(t=e.user.userData)==null?void 0:t._id}),[i,u]=o.useState([]),[r,f]=o.useState(1),[g,p]=o.useState(0),d=async()=>{try{let e;c==="admin"?(e=await C(r),l(_(0))):(e=await E(h,r),l(I(0))),e&&e.status===200?(u(t=>[...t,...e.notifications]),f(t=>t+1),p(e.totalPages)):A.error("Error while fetching notifications")}catch(e){console.log("get all notifications error: ",e)}};o.useEffect(()=>{d()},[]);const j=async(e,t)=>{try{c==="admin"?await D(e):await U(e),x(t)}catch(a){console.log(a)}},N=(e,t)=>{e.stopPropagation();try{alert(t)}catch(a){console.log(a)}};return s.jsxs("div",{className:"col-10 my-3 mx-auto",children:[s.jsx("h3",{className:"mb-4",children:"Notifications"}),i&&i.length?s.jsx(V,{dataLength:i.length,hasMore:r<=g,loader:s.jsx("div",{children:"Hang on, loading content..."}),next:d,children:s.jsx(k,{light:!0,children:i.map((e,t)=>{var a,m;return s.jsx("div",{children:s.jsxs(P,{className:"d-flex justify-content-between align-items-center px-2 mb-2",children:[s.jsxs("div",{className:"d-md-flex align-items-center",children:[s.jsx("div",{className:"d-flex align-items-center",children:s.jsx("img",{src:(a=e==null?void 0:e.from)!=null&&a.profile?`https://tasktrack.online/uploads/profile/${(m=e==null?void 0:e.from)==null?void 0:m.profile}`:L.avatar,alt:"Profile",style:{width:"40px"},className:"rounded-circle mb-2 mx-auto img-fluid"})}),s.jsx("div",{children:s.jsxs("div",{className:"ms-5",children:[s.jsx("p",{children:e.message}),s.jsx("p",{children:new Date(e.timestamp).toDateString()})]})})]}),s.jsxs("div",{className:"d-md-flex col-2 justify-content-between",children:[s.jsx("div",{className:"d-flex justify-content-center dropdown",children:s.jsx(S,{size:"sm",rounded:!0,color:"link",onClick:()=>j(e._id,e.redirectTo),children:"View"})}),s.jsxs("div",{className:"d-flex justify-content-center dropdown",children:[s.jsx("a",{className:"nav-link",onClick:n=>n.stopPropagation(),href:"#",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false",children:s.jsx("i",{className:"bi bi-three-dots"})}),s.jsx("ul",{className:"dropdown-menu",children:s.jsx("li",{children:s.jsxs("button",{className:"btn",onClick:n=>N(n,e._id),children:[s.jsx("i",{className:"bi bi-trash me-1"}),"Remove"]})})})]})]})]})},t)})})}):s.jsx("div",{children:"No notifications found"})]})};export{M as default};
