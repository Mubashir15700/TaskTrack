import{r,u as P,_ as S,j as o,L as y,S as A}from"./index-e0af1eab.js";import{T as C}from"./TableDataDisplay-dc0800c3.js";import{g as d,u as E}from"./user-3938e21e.js";import{I as $}from"./imageUrls-ebc684b3.js";import"./Pagination-81abe27a.js";const R=()=>{const[f,c]=r.useState([]),[i,a]=r.useState(),[u,p]=r.useState(0),[b,g]=r.useState(0),[n,h]=r.useState(2),m=P(e=>e.admin.searchResults);r.useEffect(()=>{const e=async()=>{try{const s=await d(n,u);s&&s.status===200&&s.users?(c(s.users),g(s.totalPages)):a("Failed to fetch users data.")}catch(s){a("An error occurred while fetching users data."),console.error("Error fetching users data:",s)}};m.searchOn==="users"?c(m.results):e()},[u,m,n]);const k=async(e,s)=>{const t=await A.confirmAction(`${s?"Unblock":"Block"}`,`Are you sure you want to ${s?"Unblock":"Block"} this user?`,`${s?"Unblock":"Block"}`,"#d9534f",`${s?"":"text"}`);t.isConfirmed&&U(e,t.value)},U=async(e,s)=>{try{const t=await E({userId:e,reason:s});if(t)if(t.status===200){const l=await d(n,u);l&&l.status===200&&l.users?c(l.users):a("Failed to fetch updated users data.")}else a(t.message)}catch(t){a("Failed to update user"),console.error("user action error: ",t)}};r.useEffect(()=>{i&&S.error(i)},[i]);const x={heading:"Users",itemsPerPage:n,onItemsPerPageChange:e=>h(e),dataTableColumns:[{name:"User",selector:e=>e.profile,cell:e=>o.jsx("img",{src:e.profile?`https://tasktrack.online/uploads/profile/${e.profile}`:$.avatar,alt:"Profile",style:{width:"40px"},className:"rounded-circle mb-2 mx-auto img-fluid"})},{name:"Username",selector:e=>e.username,sortable:!0},{name:"Email",selector:e=>e.email,sortable:!0},{name:"Phone",selector:e=>e.phone},{name:"Verified",selector:e=>e.isVerified,sortable:!0,cell:e=>e.isVerified?"Yes":"No"},{name:"Is Job Seeker",selector:e=>e.isJobSeeker,sortable:!0,cell:e=>e.isJobSeeker?"Yes":"No"},{name:"Actions",width:"220px",cell:e=>o.jsxs("div",{className:"d-flex gap-2",children:[o.jsx(y,{to:`/admin/users/${e._id}`,className:"btn btn-primary",children:"View"}),o.jsx("button",{className:`btn ${e.isBlocked?"btn-warning":"btn-danger"}`,onClick:()=>k(e._id,e.isBlocked),children:e.isBlocked?"Unblock":"Block"})]})}],dataTableData:f,pageCount:b,onPageChange:({selected:e})=>p(e)};return o.jsx(C,{...x})};export{R as default};
