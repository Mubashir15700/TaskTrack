import{r as i,u as g,j as s,C as y,_ as m}from"./index-4386c688.js";import{I as A}from"./index.es-7fb2a029.js";import{J as D}from"./Job-466a828e.js";import{N as F}from"./NearMeButton-00977495.js";import"./imageUrls-ebc684b3.js";const E=()=>{const[l,c]=i.useState([]),[f,v]=i.useState(1),[J,h]=i.useState(0),[L,p]=i.useState(!1),d=g(e=>{var t;return(t=e.user)==null?void 0:t.searchResults}),x=g(e=>{var t,a;return(a=(t=e.user)==null?void 0:t.userData)==null?void 0:a._id});let o;x&&(o=g(e=>{var t,a;return(a=(t=e.user)==null?void 0:t.userData)==null?void 0:a.location}),o&&typeof o=="string"&&(o=JSON.parse(o)));const{lat:j,lon:b}=o||{},u=async(e,t,a)=>{try{p(!0);const r=await y(x,e,t,a);r&&r.status===200?(c(n=>[...n,...r.jobs]),v(n=>n+1),h(r.totalPages)):m.error("Failed to fetch jobs")}catch(r){m.error("An error occured while fetching jobs"),console.log(r)}finally{p(!1)}};i.useEffect(()=>{d.searchOn==="jobs"?c(d.results):u(f)},[d]);const S=()=>{j&&b?(c([]),h(0),u(1,j,b)):(m.error("Latitude and longitude are not available."),console.log("Latitude and longitude are not available."))};return s.jsx("div",{className:"col-10 mx-auto my-3",children:L?s.jsx(s.Fragment,{children:"Loading..."}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[s.jsx("h3",{className:"mb-0",children:"Jobs"}),s.jsx(F,{text:"Find jobs near me",purpose:"jobs",onClickNearMe:S})]}),l.length?s.jsx(A,{dataLength:l.length,hasMore:f<=J,loader:s.jsx("div",{children:"Hang on, loading content..."}),next:()=>u(),children:l.map((e,t)=>{var a,r,n,N;return s.jsx("div",{className:"card mb-3",children:s.jsx(D,{isListed:!1,title:e.title,profile:(a=e.userDetails)==null?void 0:a.profile,username:(r=e.userDetails)==null?void 0:r.username,description:e.description,village:(n=e.location)==null?void 0:n.village,district:(N=e.location)==null?void 0:N.district,postedAt:e.postedAt,status:e.status,id:e._id})},t)})}):s.jsx("div",{children:"No data found"})]})})};export{E as default};
